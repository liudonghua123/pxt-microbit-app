var pxt;"undefined"==typeof navigator||!/Trident/i.test(navigator.userAgent)||/skipbrowsercheck=1/i.exec(window.location.href)||/\/browsers/i.exec(window.location.href)||(window.location.href="/browsers"),function(e){const t=[];let r,n,o,s,i=!1,a=!1,p=!1;class c{constructor(e){this.log=e,this.q=[],t.push(this)}track(e,t,r){i?this.log(e,t,r):(this.q.push([e,t,r]),this.q.length>20&&this.q.shift())}flush(){for(;this.q.length;){const[e,t,r]=this.q.shift();this.log(e,t,r)}}}function f(){const e=[];return{subscribe:t=>(e.push(t),()=>{const r=e.indexOf(t);-1!==r&&e.splice(r,1)}),emit(t){e.forEach((e=>e(t)))}}}function l(e=!1){try{const e=new URLSearchParams(window.location.search);e.has("partner")&&(r=e.get("partner"))}catch(e){console.warn("Could not parse search string",e)}const n=window.loadAppInsights;n&&(p=n(e,u),i=!0,t.forEach((e=>e.flush())))}function u(e){const t=window.pxtConfig;if("PageviewData"==e.baseType&&!e.baseData.properties)return!1;if("PageviewPerformanceData"==e.baseType){const t=e.baseData.name;e.baseData.name=window.location.origin,e.baseData.properties||(e.baseData.properties={}),e.baseData.properties.pageName=t,e.baseData.properties.pathName=window.location.pathname}if(void 0===t||!t)return!0;const n=e.baseData;n.properties=n.properties||{},n.properties.target=t.targetId,n.properties.stage=(t.relprefix||"/--").replace(/[^a-z]/gi,""),r&&(n.properties.partner=r);const o=navigator.userAgent.toLowerCase(),s=/\belectron\/(\d+\.\d+\.\d+.*?)(?: |$)/i.exec(o);s&&(n.properties.Electron=1,n.properties.ElectronVersion=s[1]);const i=window.pxtElectron;void 0!==i&&(n.properties.PxtElectron=1,n.properties.ElectronVersion=i.versions.electronVersion,n.properties.ChromiumVersion=i.versions.chromiumVersion,n.properties.NodeVersion=i.versions.nodeVersion,n.properties.PxtElectronVersion=i.versions.pxtElectronVersion,n.properties.PxtCoreVersion=i.versions.pxtCoreVersion,n.properties.PxtTargetVersion=i.versions.pxtTargetVersion,n.properties.PxtElectronIsProd=i.versions.isProd);const c=/\((MakeCode Arcade Kiosk UWP)\/([\S]+)\/([\S]+)\)/i.exec(o);return c&&(n.properties.KioskUwp=1,n.properties.KioskUwpVersion=c[2],n.properties.KioskUwpPlatform=c[3]),n.properties.cookie=a&&p,!0}!function(e){let t;function r(){return Math.round(performance.now()-e.startTimeMs)}function n(e){let t=(e=Math.round(e))%1e3,r=Math.floor(e/1e3),n=r%60,o=Math.floor(r/60);return o>0?`${o}m${n}s`:r>5?`${r}s`:r>0?`${r}s${t}ms`:`${e}ms`}function o(t,n){const o=r();e.stats.milestones.push([t,o,n]),e.onMilestone.emit({milestone:t,time:o,params:n})}function s(){if(t=performance&&!!performance.mark&&!!performance.measure,t){performance.measure("measure from the start of navigation to now");let t=performance.getEntriesByType("measure")[0];e.startTimeMs=t.startTime}}e.onMilestone=f(),e.onMeasurement=f(),e.stats={durations:[],milestones:[]},e.isEnabled=function(){return t},e.perfReportLogged=!1,e.splitMs=r,e.prettyStr=n,e.splitStr=function(){return n(r())},e.recordMilestone=o,e.init=s,e.measureStart=function(e){t&&performance.mark(`${e} start`)},e.measureEnd=function(r,n){if(t&&performance.getEntriesByName(`${r} start`).length){performance.mark(`${r} end`),performance.measure(`${r} elapsed`,`${r} start`,`${r} end`);let t=performance.getEntriesByName(`${r} elapsed`,"measure");if(t&&1===t.length){let o=t[0],s=o.duration;s>10&&(e.stats.durations.push([r,o.startTime,s,n]),e.onMeasurement.emit({name:r,start:o.startTime,duration:s,params:n}))}performance.clearMarks(`${r} start`),performance.clearMarks(`${r} end`),performance.clearMeasures(`${r} elapsed`)}},e.report=function(r=null){if(e.perfReportLogged=!0,t){const o={},s={};let i="Performance Report:\n";i+="\n",i+="\tMilestones:\n";for(let[t,s,a]of e.stats.milestones)if(!r||t.indexOf(r)>=0){i+=`\t\t${t} @ ${n(s)}`;for(let e of Object.keys(a||{}))i+=`\n\t\t\t${e}: ${a[e]}`;i+="\n",o[t]=s}i+="\n",i+="\tMeasurements:\n";for(let[t,o,a,p]of e.stats.durations){let e=r&&t.indexOf(r)>=0;if(a>50&&!r||e){if(i+=`\t\t${t} took ~ ${n(a)}`,a>1e3){i+=` (${n(o)} - ${n(o+a)})`;for(let e of Object.keys(p||{}))i+=`\n\t\t\t${e}: ${p[e]}`}i+="\n"}s[t]=a}return console.log(i),t=!1,{milestones:o,durations:s}}},s(),o("first JS running")}(s=e.perf||(e.perf={})),e.initAnalyticsAsync=function(){(function(){const e="undefined"!=typeof window,t=e&&!!window.pxtElectron,r=e&&!!window.ipcRenderer||/ipc=1/.test(location.hash)||/ipc=1/.test(location.search);return t||r})()||function(){try{return window&&window.self!==window.top}catch(e){return!1}}()&&/nocookiebanner=1/i.test(window.location.href)?l(!0):window.pxtSkipAnalyticsCookie?l(!1):l(!0)},e.aiTrackEvent=function(e,t,r){n||(n=new c(((e,t,r)=>window.appInsights.trackEvent({name:e,properties:t,measurements:r})))),n.track(e,t,r)},e.aiTrackException=function(e,t,r){o||(o=new c(((e,t,r)=>window.appInsights.trackException({exception:e,properties:t?{...r,kind:t}:r})))),o.track(e,t,r)},e.initializeAppInsightsInternal=l,e.setInteractiveConsent=function(e){a=e}}(pxt||(pxt={}));